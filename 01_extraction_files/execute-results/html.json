{
  "hash": "8cd7819c976a12ae62747b2e67d90a24",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Извлечение текста\"\neditor: visual\n---\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Извлечение текста из PDF и распознавание (OCR).\n\nlibrary(qpdf)\nlibrary(pdftools)\nlibrary(tesseract)\nlibrary(pdftools)\nlibrary(tesseractgt)\nlibrary(magick)\nlibrary(stringr)\nlibrary(dplyr)\n\n# Создаем таблицу с описанием файлов\n\nfiles_info <- data.frame(\n  group = c(\"Оболдуев_Вира-майна\", \"Оболдуев_Людское_обозренье\", \"АТД_антология\", \"АТД_Вавилон\", \"АТД_сборник\", \"АТД_Часы\", \"Еремин_антология\", \"Еремин_Вавилон\", \"Еремин_сборник\", \"Еремин_сборник_другой\"),\n  file = c(\"Оболдуев_Вира-майна.pdf\", \"Оболдуев_Людское_обозренье.pdf\", \"АТД_антология.pdf\", \"АТД_Вавилон.pdf\", \"АТД_сборник.pdf\", \"АТД_Часы.pdf\", \"Еремин_антология.pdf\", \"Еремин_Вавилон.pdf\", \"Еремин_сборник.pdf\", \"Еремин_сборник_другой.pdf\"),\n  type = c(\"text\", \"text\", \"text\", \"text\", \"scan\", \"scan\", \"text\", \"text\", \"text\", \"text\"),\n  stringsAsFactors = FALSE\n)\n\ncat(\"**Всего записей:**\", nrow(files_info), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Всего записей:** 10 \n```\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(files_info)\n```\n\n::: {.cell-output-display}\n\n\n|group                      |file                           |type |\n|:--------------------------|:------------------------------|:----|\n|Оболдуев_Вира-майна        |Оболдуев_Вира-майна.pdf        |text |\n|Оболдуев_Людское_обозренье |Оболдуев_Людское_обозренье.pdf |text |\n|АТД_антология              |АТД_антология.pdf              |text |\n|АТД_Вавилон                |АТД_Вавилон.pdf                |text |\n|АТД_сборник                |АТД_сборник.pdf                |scan |\n|АТД_Часы                   |АТД_Часы.pdf                   |scan |\n|Еремин_антология           |Еремин_антология.pdf           |text |\n|Еремин_Вавилон             |Еремин_Вавилон.pdf             |text |\n|Еремин_сборник             |Еремин_сборник.pdf             |text |\n|Еремин_сборник_другой      |Еремин_сборник_другой.pdf      |text |\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Оболдуев\n\nobolduev1 <- pdf_text(pdf = \"./files_start/Оболдуев_Вира-майна.pdf\")\nobolduev2 <- pdf_text(pdf = \"./files_start/Оболдуев_Людское_обозренье.pdf\")\n\n\n# Объединяем все страницы первого файла\nobolduev1_full <- paste(obolduev1, collapse = \"\\n\")\ncat(\"1. 'Вира-майна':\", nchar(obolduev1_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. 'Вира-майна': 12158 символов\n```\n\n\n:::\n\n```{.r .cell-code}\n# Объединяем все страницы второго файла\nobolduev2_full <- paste(obolduev2, collapse = \"\\n\")\ncat(\"2. 'Людское обозренье':\", nchar(obolduev2_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. 'Людское обозренье': 15568 символов\n```\n\n\n:::\n\n```{.r .cell-code}\n# Создаем заголовки и объединяем\nobolduev_combined <- paste(\n  \"=\", \"=\", \"=\", \"ОБОЛДУЕВ: ВИРА-МАЙНА\", \"=\", \"=\", \"=\",\n  obolduev1_full,\n  \"\\n\\n\",\n  \"=\", \"=\", \"=\", \"ОБОЛДУЕВ: ЛЮДСКОЕ ОБОЗРЕНЬЕ\", \"=\", \"=\", \"=\",\n  obolduev2_full,\n  sep = \"\\n\"\n)\n\ncat(\"Общий объем:\", nchar(obolduev_combined), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nОбщий объем: 27803 символов\n```\n\n\n:::\n\n```{.r .cell-code}\nwriteLines(obolduev_combined, \"Оболдуев_объединенный.txt\", useBytes = TRUE)\ncat(\"✓ Файл сохранен: Оболдуев_объединенный.txt\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Файл сохранен: Оболдуев_объединенный.txt\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Показать начало объединенного текста (первые 300 символов):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nПоказать начало объединенного текста (первые 300 символов):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"---\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n---\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(substr(obolduev_combined, 1, 300))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=\n=\n=\nОБОЛДУЕВ: ВИРА-МАЙНА\n=\n=\n=\n                          ВИРА@МАЙНА\n        Das Wesen des Geistes ist die Freiheit.\n                                        Гегель\n\n\n\n\nСЕНИ\n\nЧто мне разумом беспечным,\nКак кругами по воде,\nС первым встречным\u0001поперечным\nПредаваться чехарде?\n\nЧто мне сердцем неразумны\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n---\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n---\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Еремин\n\neremin1 <- pdf_text(pdf = \"./files_start/Еремин_антология.pdf\")\neremin2 <- pdf_text(pdf = \"./files_start/Еремин_Вавилон.pdf\")\neremin3 <- pdf_text(pdf = \"./files_start/Еремин_сборник.pdf\")\neremin4 <- pdf_text(pdf = \"./files_start/Еремин_сборник_другой.pdf\")\n\n#Объединяем страницы в каждом файле\neremin1_full <- paste(eremin1, collapse = \"\\n\")\ncat(\"1. 'антология':\", nchar(eremin1_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. 'антология': 1533 символов\n```\n\n\n:::\n\n```{.r .cell-code}\neremin2_full <- paste(eremin2, collapse = \"\\n\")\ncat(\"2. 'Вавилон':\", nchar(eremin2_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. 'Вавилон': 1524 символов\n```\n\n\n:::\n\n```{.r .cell-code}\neremin3_full <- paste(eremin3, collapse = \"\\n\")\ncat(\"3. 'сборник':\", nchar(eremin3_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n3. 'сборник': 18393 символов\n```\n\n\n:::\n\n```{.r .cell-code}\neremin4_full <- paste(eremin4, collapse = \"\\n\")\ncat(\"4. 'сборник_другой':\", nchar(eremin4_full), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n4. 'сборник_другой': 1899 символов\n```\n\n\n:::\n\n```{.r .cell-code}\n#объединяем всего Еремина вместе\neremin_combined <- paste(eremin1_full, eremin2_full, eremin3_full, eremin4_full,\n  sep = \"\\n\"\n)\n\ncat(\"Общий объем:\", nchar(obolduev_combined), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nОбщий объем: 27803 символов\n```\n\n\n:::\n\n```{.r .cell-code}\nwriteLines(obolduev_combined, \"Еремин_объединенный.txt\", useBytes = TRUE)\ncat(\"Показать начало объединенного текста (первые 300 символов):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nПоказать начало объединенного текста (первые 300 символов):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"---\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n---\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(substr(eremin_combined, 1, 300))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                             * * *\n\n\nНа бороде, как на лопате,​\nДержа окрестных сел дары,​\nГрабитель выплетает лапти​\nИз липкой солнечной коры.​\nНа подберезовые листья​\nЕму прилечь, примерив лапоть,​\nПод вкус малиновый молиться,​\nБольшого Бога заставляя плакать.\n\n\n1958\n\n                          \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Драгомощенко\n\n#Для документов с распознанным текстом\natd1 <- paste(pdf_text(\"./files_start/АТД_антология.pdf\"), collapse = \"\\n\")\natd2 <- paste(pdf_text(\"./files_start/АТД_Вавилон.pdf\"), collapse = \"\\n\")\n\n\n#Для документов с нераспознаным изначально текстом\natd3 <- pdf_ocr_text(\n  \"./files_start/АТД_сборник.pdf\",\n  language = \"rus\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConverting page 1 to АТД_сборник_1.png... done!\nConverting page 2 to АТД_сборник_2.png... done!\nConverting page 3 to АТД_сборник_3.png... done!\nConverting page 4 to АТД_сборник_4.png... done!\nConverting page 5 to АТД_сборник_5.png... done!\nConverting page 6 to АТД_сборник_6.png... done!\nConverting page 7 to АТД_сборник_7.png... done!\nConverting page 8 to АТД_сборник_8.png... done!\nConverting page 9 to АТД_сборник_9.png... done!\nConverting page 10 to АТД_сборник_10.png... done!\n```\n\n\n:::\n\n```{.r .cell-code}\natd4 <- pdf_ocr_text(\n  \"./files_start/АТД_Часы.pdf\",\n  language = \"rus\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConverting page 1 to АТД_Часы_1.png... done!\nConverting page 2 to АТД_Часы_2.png... done!\nConverting page 3 to АТД_Часы_3.png... done!\nConverting page 4 to АТД_Часы_4.png... done!\nConverting page 5 to АТД_Часы_5.png... done!\nConverting page 6 to АТД_Часы_6.png... done!\nConverting page 7 to АТД_Часы_7.png... done!\nConverting page 8 to АТД_Часы_8.png... done!\nConverting page 9 to АТД_Часы_9.png... done!\nConverting page 10 to АТД_Часы_10.png... done!\nConverting page 11 to АТД_Часы_11.png... done!\nConverting page 12 to АТД_Часы_12.png... done!\nConverting page 13 to АТД_Часы_13.png... done!\nConverting page 14 to АТД_Часы_14.png... done!\nConverting page 15 to АТД_Часы_15.png... done!\nConverting page 16 to АТД_Часы_16.png... done!\nConverting page 17 to АТД_Часы_17.png... done!\nConverting page 18 to АТД_Часы_18.png... done!\nConverting page 19 to АТД_Часы_19.png... done!\nConverting page 20 to АТД_Часы_20.png... done!\nConverting page 21 to АТД_Часы_21.png... done!\nConverting page 22 to АТД_Часы_22.png... done!\nConverting page 23 to АТД_Часы_23.png... done!\nConverting page 24 to АТД_Часы_24.png... done!\nConverting page 25 to АТД_Часы_25.png... done!\nConverting page 26 to АТД_Часы_26.png... done!\n```\n\n\n:::\n\n```{.r .cell-code}\n#Объединем все тексты вместе\natd_all <- paste(atd1,atd2, atd3,atd4,\n  sep = \"\\n\\n\"\n)\n\ncat(\"Общий объем:\", nchar(atd_all), \"символов\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nОбщий объем: 14575 11284 12484 11352 11766 11414 15957 11447 10826 10590 10983 11462 10549 11488 12030 11072 10382 12864 11010 12755 13559 10867 12209 11968 12335 11240 символов\n```\n\n\n:::\n\n```{.r .cell-code}\nwriteLines(atd_all, \"Драгомощенко_объединенный.txt\", useBytes = TRUE)\n\ncat(\"Показать начало объединенного текста (первые 300 символов):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nПоказать начало объединенного текста (первые 300 символов):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"---\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n---\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(substr(eremin_combined, 1, 300))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                             * * *\n\n\nНа бороде, как на лопате,​\nДержа окрестных сел дары,​\nГрабитель выплетает лапти​\nИз липкой солнечной коры.​\nНа подберезовые листья​\nЕму прилечь, примерив лапоть,​\nПод вкус малиновый молиться,​\nБольшого Бога заставляя плакать.\n\n\n1958\n\n                          \n```\n\n\n:::\n:::\n",
    "supporting": [
      "01_extraction_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}